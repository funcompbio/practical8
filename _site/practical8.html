<h1 id="objectives">Objectives</h1>
<p>The learning objectives for this practical are:</p>
<ul>
<li>Start and quit R and RStudio.</li>
<li>Get familiar with the RStudio interface.</li>
<li>Getting and setting the working directory in R.</li>
<li>Reading CSV files.</li>
<li>Subsetting rows of a data frame</li>
<li>Simple plotting</li>
</ul>
<h1 id="setup-and-background">Setup and background</h1>
<p>To do this practical you need an installation of R and RStudio. You can find the instructions in the <a href="/setup/">setup</a> link on how to install R and RStudio in your system. Once R and RStudio are installed, you should be able to start RStudio by double-clicking on an icon like the one here below.</p>
<div class="figure">
<img src="RStudioIcon.png" />

</div>
<p>We will download some COVID19 data to illustrate the use of R and RStudio. Please follow the next two steps:</p>
<ol style="list-style-type: decimal">
<li>Go to the Catalan Health Departament COVID19 data portal at <a href="https://dadescovid.cat" class="uri">https://dadescovid.cat</a> and switch the language to &quot;ENGLISH&quot; using the pull-down menu on the top-right corner of the page.</li>
<li>Follow the downloads link and on the next page click and download the file corresponding to the &quot;7 DAY AGGREGATION&quot; for &quot;CATALUNYA&quot;. Make sure you know exactly where in your filesystem this file has been downloaded. <strong>Tip:</strong> some browsers automatically download files into a folder called &quot;Downloads&quot; or under a name corresponding to the translation of &quot;Downloads&quot; to the default language of your operating system.</li>
<li>Make a directory in your filesystem, for instance at your <em>home</em> directory, called <code>practical8</code> and copy in it the downloaded file.</li>
<li>Since the downloaded file is a ZIP file, uncompress as you did in <a href="/practical1/">practical 1</a> so that you finally have a file called <code>catalunya_setmanal.csv</code> in the directory <code>practical8</code>.</li>
</ol>
<p>If you are using the UPF <em>myapps</em> cloud to run RStudio, then you need to either use an internet browser in <em>myapps</em> to download the data file directly in the <em>myapps</em> cloud or upload to the <em>myapps</em> cloud the file that you have downloaded in your own computer.</p>
<h1 id="starting-r-and-rstudio">Starting R and RStudio</h1>
<p>RStudio is the most popular graphical user interface (GUI), or rather the most popular <a href="https://en.wikipedia.org/wiki/Integrated_development_environment">integrated development environment (IDE)</a>, for working <strong>with</strong> R. However, RStudio <strong>is not</strong> R. RStudio <strong>runs</strong> R. You can also run and work with R <strong>without</strong> RStudio. In fact, if you need to work with R in a remote server to which you only have a text-based connection through a terminal window, then you <strong>cannot</strong> use RStudio. If for whatever reason, you cannot use RStudio, you can still follow this practical, skipping the parts that specifically refer to the GUI of RStudio.</p>
<p>Once you have started RStudio, you should see its application window, which should be similar to this one below.</p>
<div class="figure">
<img src="RStudioFreshStart.png" />

</div>
<p>The RStudio window is initially divided in three main panes:</p>
<ul>
<li><strong>R shell:</strong> where you can interactively type R commands.</li>
<li><strong>Environment / history:</strong> where you can browse through the objects that are being created and the commands that you have typed in the R shell.</li>
<li><strong>Files / plots / pkgs / help:</strong> where you can navigate through the filesystem where RStudio is running and change the working directory, visualize plotting output, browse through the loaded packages and read help pages.</li>
</ul>
<p>If you cannot start RStudio but you have installed R, you still can start R by typing on the Unix shell command line:</p>
<pre><code>$ R</code></pre>
<p>Your terminal window should then be running R and looking similar to the one below.</p>
<div class="figure">
<img src="Rterminal.png" />

</div>
<h1 id="quitting-r-and-rstudio">Quitting R and RStudio</h1>
<p>To quit R and RStudio you should type the following instruction in the R shell:</p>
<pre><code>&gt; q()</code></pre>
<p>You should <strong>not</strong> type the <code>&gt;</code> character, since it corresponds to the R prompt and only indicates that the given instruction to the right of that character should be typed in the R shell. Normally, after that instruction R will ask:</p>
<pre><code>&gt; q()
Save workspace image? [y/n/c]:</code></pre>
<p>If you answer <code>y</code> then R will store all the objects you have created in a hidden file called <code>.RData</code> and next time you start R, all those objects will be automatically loaded. In such a case, R will show you the next message at startup:</p>
<pre><code>[Previously saved workspace restored]</code></pre>
<p>In general, there is no reason to save the workspace when you quit R, so you should always answer <code>n</code> to that question. The answer <code>c</code> <em>cancels</em> the quitting instruction. In RStudio you can also quit R and RStudio by either closing the application window or through the <code>Quit</code> option in the <em>File</em> or <em>RStudio</em> top-level menu.</p>
<h1 id="r-as-a-calculator">R as a calculator</h1>
<p>The R shell can be directly used as a calculator, type the following instructions and figure out what the operators do:</p>
<pre><code>&gt; 1+1
&gt; 5-4
&gt; 3*2
&gt; 6/2
&gt; 4%%3
&gt; 2**3
&gt; 2^3</code></pre>
<p>Now, type the following and press enter:</p>
<pre><code>&gt; 1+</code></pre>
<p>You should have obtained the following output:</p>
<pre><code>&gt; 1+
+</code></pre>
<p>where the cursor is next to the plus sign (<code>+</code>) that has appeared in the line below. This plus sign indicates that the expression you have written is incomplete. This often happens when there is, for instance, a missing closing parenthesis. In this situation you can do two things: (1) you complete the instruction or (2) you press the <code>Esc</code> key, which will cancel the instruction. Try cancelling this incomplete sum with the <code>Esc</code> key.</p>
<p>Now try to calculate the natural logarithm of 10 by typing:</p>
<pre><code>&gt; log(10)</code></pre>
<p>If you are using RStudio, note that when you have typed the name of the function <code>log</code>, RStudio shows you a popup with contextual help, which you can use to choose among functions that have <code>log</code> as a prefix in their name.</p>
<h1 id="getting-and-setting-the-working-directory">Getting and setting the working directory</h1>
<p>Whenever we want to read or write data files to a specific working directory, we need to make sure that the default directory access or R is pointing to that directory. To find out the default working directory of R, you should call the <code>getwd()</code> function in the R shell:</p>
<pre><code>&gt; getwd()</code></pre>
<p>If the return path is not the working directory that we want, we can change it with the function <code>setwd(dir)</code> where <code>dir</code> should be the path that we want to set as working directory. In RStudio, using the <em>Files</em> pane, we can navigate through the file system to the directory we want to set as working directory and then click on the <code>More</code> pull-down menu and select <code>Set As Working Directory</code>.</p>
<p>Using the function <code>setwd()</code>, or the RStudio <em>Files</em> pane, change the working directory to the path <code>practical8</code> that you should have created at the beginning of this practical and where you have downloaded the file <code>catalunya_setmanal.csv</code>.</p>
<h1 id="reading-csv-files">Reading CSV files</h1>
<p>We can read CSV files in R using the function <code>read.csv()</code>. Let's read the CSV file <code>catalunya_setmanal.csv</code> as follows:</p>
<pre><code>&gt; dat &lt;- read.csv(&quot;catalunya_setmanal.csv&quot;, sep=&quot;;&quot;, stringsAsFactors=TRUE)</code></pre>
<p>Note that when writing the first letters of the filename, you can <em>autocomplete</em> the rest of the filename by pressing the <code>TAB</code> key. Next to the filename as a first argument, we also specified that the column delimiter in <code>comarques_setmanal.csv</code> is a semicolon <code>;</code> and that we want R to treat character columns as a special kind of object called <em>factor</em>.</p>
<p>The <code>read.csv()</code> function returns a <code>data.frame</code> object. You can verify it by typing</p>
<pre><code>&gt; class(dat)
[1] &quot;data.frame&quot;</code></pre>
<p>Figure out the dimensions of this <code>data.frame</code> object with the function <code>dim()</code>.</p>
<p>Examine the first and last rows of this <code>data.frame</code> object with the functions <code>head()</code> and <code>tail()</code>. If you are running RStudio, go to the <code>Environment</code> pane and click on the small right triangle icon next to the object name and then over the object name.</p>
<p>A quick way to get a summary of the data stored in a <code>data.frame</code> object is by calling the function <code>summary()</code> with that object as argument. Call <code>summary()</code> on the previous <code>data.frame</code> object and you should be getting an output similar to this one:</p>
<pre><code>&gt; summary(dat)
        NOM             CODI           DATA_INI         DATA_FI    RESIDENCIA
 CATALUNYA:756   CATALUNYA:756   2020-02-24:  3   2020-03-01:  3   --:252    
                                 2020-02-25:  3   2020-03-02:  3   No:252    
                                 2020-02-26:  3   2020-03-03:  3   Si:252    
                                 2020-02-27:  3   2020-03-04:  3             
                                 2020-02-28:  3   2020-03-05:  3             
                                 2020-02-29:  3   2020-03-06:  3             
                                 (Other)   :738   (Other)   :738             
 IEPG_CONFIRMAT    R0_CONFIRMAT_M        IA14         TAXA_CASOS_CONFIRMAT
 Min.   :  11.25   Min.   :0.6378   Min.   :    0.0   Min.   :   0.00     
 1st Qu.:  33.50   1st Qu.:0.9355   1st Qu.:    0.0   1st Qu.:   0.00     
 Median : 170.31   Median :1.0803   Median :   93.5   Median :  44.24     
 Mean   : 208.45   Mean   :1.2490   Mean   :  640.0   Mean   : 328.19     
 3rd Qu.: 221.46   3rd Qu.:1.3392   3rd Qu.:  474.3   3rd Qu.: 231.08     
 Max.   :1045.88   Max.   :5.0000   Max.   :10867.6   Max.   :6214.35     
 NA&#39;s   :517       NA&#39;s   :517                                            
 CASOS_CONFIRMAT  TAXA_PCR_TAR          PCR                TAR         
 Min.   :    0   Min.   :    0.0   Min.   :     0.0   Min.   :    0.0  
 1st Qu.:   82   1st Qu.:    0.0   1st Qu.:   812.8   1st Qu.:    0.0  
 Median :  234   Median :  526.8   Median :  4099.0   Median :    0.0  
 Mean   : 2421   Mean   : 3214.0   Mean   : 25724.0   Mean   :  825.3  
 3rd Qu.: 2035   3rd Qu.: 5447.2   3rd Qu.: 32643.0   3rd Qu.:    0.0  
 Max.   :32208   Max.   :27398.1   Max.   :228917.0   Max.   :61154.0  
                                                                       
 PERC_PCR_TAR_POSITIVES INGRESSOS_TOTAL   INGRESSOS_CRITIC     EXITUS       
 Min.   :  0.000        Min.   :   0.00   Min.   :  0.00   Min.   :   0.00  
 1st Qu.:  3.239        1st Qu.:   4.75   1st Qu.:  0.00   1st Qu.:   1.00  
 Median :  6.247        Median :  38.00   Median :  2.00   Median :  24.00  
 Mean   :  9.904        Mean   : 156.18   Mean   : 23.41   Mean   : 134.32  
 3rd Qu.:  9.176        3rd Qu.: 124.25   3rd Qu.: 19.00   3rd Qu.:  66.25  
 Max.   :100.000        Max.   :1866.00   Max.   :357.00   Max.   :1637.00  </code></pre>
<h1 id="subsetting-rows-of-a-data-frame">Subsetting rows of a data frame</h1>
<p>Using the previously loaded <code>data.frame</code> object, build a vector of logical values (a so-called <em>logical mask</em>) in one-to-one correspondence with the rows, where a position in the vector is <code>TRUE</code> if the corresponding row contains data belonging to the general population, i.e., excluding geriatric residences. Take into account that the comparison operators in R are <code>==</code> for equality, <code>!=</code> for inequality, <code>&gt;</code> for larger than, <code>&lt;</code> for smaller than, <code>&gt;=</code> for larger or equal than and <code>&lt;=</code> for smaller or equal than`.</p>
<p>Using that logical mask, obtain a new <code>data.frame</code> object that includes only data rows from the general population. Verify that the number of rows in the new object matches the sum of <code>TRUE</code> values in the logical mask.</p>
<h1 id="simple-plotting">Simple plotting</h1>
<p>The main function to plot data points in (base) R is the function <code>plot()</code>. Type the following call to the <code>plot()</code> function in the R shell:</p>
<pre><code>plot(1:10)</code></pre>
<p>It should produce the following plot.</p>
<div class="figure">
<img src="simpleplot.png" />

</div>
<p>Try to understand what is this function call plotting. Now, type this other call:</p>
<pre><code>plot(1:10, 2^(1:10))</code></pre>
<p>Think about the difference between the two plots. Repeat again the last call with the argument <code>type=&quot;l&quot;</code>. What did this argument change?</p>
<p>Using the <code>data.frame</code> object with COVID19 data from the general population obtained in the previous section and the <code>plot()</code> function, try to reproduce the <strong>shape</strong> of the plots shown at the front page of the Catalan COVID19 data portal at <a href="https://dadescovid.cat" class="uri">https://dadescovid.cat</a>. It is not necessary to reproduce details such as colors, axis labels and legends, a single solid line showing the shape of the plotted values is enough.</p>
